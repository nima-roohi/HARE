VARIABLES [ x1, x2, x3 ] (* three rooms *)
MODES [ m1 , m2, m3, m4, m5, m6, m7]
STATESPACE 
  m1[[14, 21], [14, 21], [14,22]] (* heaters on in rooms 1 and 2 *)
  m2[[14, 21], [14, 22], [14,21]] (* heaters on in rooms 1 and 3 *)
  m3[[14, 22], [14, 21], [14,21]] (* heaters on in rooms 2 and 3 *)
  m4[[14, 21], [18, 22], [18,22]] (* heater on in room 1, second heater off *)
  m5[[18, 22], [14, 21], [18,22]] (* heater on in room 2, second heater off *)
  m6[[18, 22], [18, 22], [14,21]] (* heater on in room 3, second heater off *)
  m7[[18, 22], [18, 22], [18,22]] (* all heaters off *)
INITIAL 
  m1{x1=20/\x2=20/\x3=20}
FLOW
  m1{x1_d=-0.9*x1+0.5*x2+7.6}{x2_d=0.5*x1-1.3*x2+0.5*x3+8.2}{x3_d=0.5*x2-0.9*x3+1.6}
  m2{x1_d=-0.9*x1+0.5*x2+7.6}{x2_d=0.5*x1-1.3*x2+0.5*x3+1.2}{x3_d=0.5*x2-0.9*x3+9.6}
  m3{x1_d=-0.9*x1+0.5*x2+1.6}{x2_d=0.5*x1-1.3*x2+0.5*x3+8.2}{x3_d=0.5*x2-0.9*x3+9.6}
  m4{x1_d=-0.9*x1+0.5*x2+7.6}{x2_d=0.5*x1-1.3*x2+0.5*x3+1.2}{x3_d=0.5*x2-0.9*x3+1.6}
  m5{x1_d=-0.9*x1+0.5*x2+1.6}{x2_d=0.5*x1-1.3*x2+0.5*x3+8.2}{x3_d=0.5*x2-0.9*x3+1.6}
  m6{x1_d=-0.9*x1+0.5*x2+1.6}{x2_d=0.5*x1-1.3*x2+0.5*x3+1.2}{x3_d=0.5*x2-0.9*x3+9.6}
  m7{x1_d=-0.9*x1+0.5*x2+1.6}{x2_d=0.5*x1-1.3*x2+0.5*x3+1.2}{x3_d=0.5*x2-0.9*x3+1.6}  
JUMP
  m1->m2{[x1<21/\x3<=18/\x2-x3>=1]/\[x1'=x1/\x2'=x2/\x3'=x3]}
  m1->m3{[x2<21/\x3<=18/\x1-x3>=1]/\[x1'=x1/\x2'=x2/\x3'=x3]}
  m1->m4{[x1<21/\x2>=21/\[x3>18\/x2-x3<1]]/\[x1'=x1/\x2'=x2/\x3'=x3]}
  m1->m5{[x1>=21/\x2<21/\[x3>18\/x1-x3<1]]/\[x1'=x1/\x2'=x2/\x3'=x3]}
  m1->m6{[[x1>=21/\x3<=18/\x2-x3>=1]\/[x2>=21/\x3<=18/\x1-x3>=1]]/\[x1'=x1/\x2'=x2/\x3'=x3]}
  m1->m7{[x1>=21/\x2>=21/\[x3>18\/x1-x3<1\/x2-x3<1]]/\[x1'=x1/\x2'=x2/\x3'=x3]}
  m2->m1{[x1<21/\x2<=18/\x3-x2>=1]/\[x1'=x1/\x2'=x2/\x3'=x3]}
  m2->m3{[x3<21/\x2<=18/\x1-x3>=1]/\[x1'=x1/\x2'=x2/\x3'=x3]}
  m2->m4{[x1<21/\[x2>18\/x3-x2<1]/\x3>=21]/\[x1'=x1/\x2'=x2/\x3'=x3]}
  m2->m5{[[x1>=21/\x2<=18/\x3-x2>=1]\/[x3>=21/\x2<=18/\x1-x2>=1]]/\[x1'=x1/\x2'=x2/\x3'=x3]}
  m2->m6{[[x2>18\/x1-x2<1]/\x1>=21/\x3<21]/\[x1'=x1/\x2'=x2/\x3'=x3]}
  m2->m7{[x1>=21/\x3>=21/\[x2>18\/x1-x2<1\/x3-x2<1]]/\[x1'=x1/\x2'=x2/\x3'=x3]}
  m3->m1{[x2<21/\x1<=18/\x3-x1>=1]/\[x1'=x1/\x2'=x2/\x3'=x3]}
  m3->m2{[x3<21/\x1<=18/\x2-x1>=1]/\[x1'=x1/\x2'=x2/\x3'=x3]}
  m3->m4{[[x2>=21/\x1<=18/\x3-x1>=1]\/[x3>=21/\x1<=18/\x2-x1>=1]]/\[x1'=x1/\x2'=x2/\x3'=x3]}
  m3->m5{[[x1>18\/x3-x1<1]/\x2<21/\x3>=21]/\[x1'=x1/\x2'=x2/\x3'=x3]}
  m3->m6{[[x1>18\/x2-x1<1]/\x3<21/\x2>=21]/\[x1'=x1/\x2'=x2/\x3'=x3]}
  m3->m7{[[x1>18\/x2-x1<1\/x3-x1<1]/\x2>=21/\x3>=21]/\[x1'=x1/\x2'=x2/\x3'=x3]}
  m4->m1{[[[x1<21/\x2<=20]/\[x1'=x1/\x2'=x2/\x3'=x3]]\/[[x1<21/\x2<=18/\x3-x2>=1/\x3>20]/\[x1'=x1/\x2'=x2/\x3'=x3]]]}
  m4->m2{[[[x1<21/\x3<=20]/\[x1'=x1/\x2'=x2/\x3'=x3]]\/[[x1<21/\x3<=18/\x2-x3>=1/\x2>20]/\[x1'=x1/\x2'=x2/\x3'=x3]]]}
  m4->m3{[[[x2<=20/\x3<=18/\x1-x3>=1]/\[x1'=x1/\x2'=x2/\x3'=x3]]\/[[x3<=20/\x2<=18/\x1-x2>=1]/\[x1'=x1/\x2'=x2/\x3'=x3]]]}
  m4->m5{[[[x1>=21/\x2<=20/\[x3>18\/x1-x3<1\/x2-x3<1]]/\[x1'=x1/\x2'=x2/\x3'=x3]]\/[[x1>=21/\x2<=18/\x3-x2>=1/\x3>20]/\[x1'=x1/\x2'=x2/\x3'=x3]]\/[[x3>20/\x2<=18/\x1-x2>=1/\x1<21]/\[x1'=x1/\x2'=x2/\x3'=x3]]]}
  m4->m6{[[[x1>=21/\x3<=20/\[x2>18\/x1-x2<1\/x3-x2<1]]/\[x1'=x1/\x2'=x2/\x3'=x3]]\/[[x1>=21/\x3<=18/\x2-x3>=1/\x2>20]/\[x1'=x1/\x2'=x2/\x3'=x3]]\/[[x2>20/\x3<=18/\x1-x3>=1/\x1<21]/\[x1'=x1/\x2'=x2/\x3'=x3]]]}
  m4->m7{[[x1>=21/\x2>20/\[x3>18\/x1-x3<1\/x2-x3<1]]\/[x1>=21/\x3>20/\[x2>18\/x1-x2<1\/x3-x2<1]]]/\[x1'=x1/\x2'=x2/\x3'=x3]}
  m5->m1{[[[x2<21/\x1<=20]/\[x1'=x1/\x2'=x2/\x3'=x3]]\/[[x1<=18/\x3-x1>=1/\x3>20/\x2<21]/\[x1'=x1/\x2'=x2/\x3'=x3]]]}
  m5->m2{[[[x1<=20/\x3<=18/\x2-x3>=1]/\[x1'=x1/\x2'=x2/\x3'=x3]]\/[[x3<=20/\x1<=18/\x2-x1>=1]/\[x1'=x1/\x2'=x2/\x3'=x3]]]}
  m5->m3{[[[x2<21/\x3<=20]/\[x1'=x1/\x2'=x2/\x3'=x3]]\/[[x2<21/\x3<=18/\x1-x3>=1/\x1>20]/\[x1'=x1/\x2'=x2/\x3'=x3]]]}
  m5->m4{[[[x2>=21/\x1<=20/\[x3>18\/x2-x3<1\/x1-x3<1]]/\[x1'=x1/\x2'=x2/\x3'=x3]]\/[[x2>=21/\x1<=18/\x3-x1>=1/\x3>20]/\[x1'=x1/\x2'=x2/\x3'=x3]]\/[[x3>20/\x1<=18/\x2-x1>=1/\x2<21]/\[x1'=x1/\x2'=x2/\x3'=x3]]]}
  m5->m6{[[[x2>=21/\x3<=20/\[x1>18\/x2-x1<1\/x3-x1<1]]/\[x1'=x1/\x2'=x2/\x3'=x3]]\/[[x2>=21/\x3<=18/\x1-x3>=1/\x1>20]/\[x1'=x1/\x2'=x2/\x3'=x3]]\/[[x1>20/\x3<=18/\x2-x3>=1/\x2<21]/\[x1'=x1/\x2'=x2/\x3'=x3]]]}
  m5->m7{[[x2>=21/\x1>20/\[x3>18\/x2-x3<1\/x1-x3<1]]\/[x2>=21/\x3>20/\[x1>18\/x2-x1<1\/x3-x1<1]]]/\[x1'=x1/\x2'=x2/\x3'=x3]}
  m6->m1{[[[x1<=20/\x2<=18/\x3-x2>=1]/\[x1'=x1/\x2'=x2/\x3'=x3]]\/[[x2<=20/\x1<=18/\x3-x1>=1]/\[x1'=x1/\x2'=x2/\x3'=x3]]]}
  m6->m2{[[[x3<21/\x1<=20]/\[x1'=x1/\x2'=x2/\x3'=x3]]\/[[x3<21/\x1<=18/\x2-x1>=1/\x2>20]/\[x1'=x1/\x2'=x2/\x3'=x3]]]}
  m6->m3{[[[x3<21/\x2<=20]/\[x1'=x1/\x2'=x2/\x3'=x3]]\/[[x3<21/\x2<=18/\x1-x2>=1/\x1>20]/\[x1'=x1/\x2'=x2/\x3'=x3]]]}
  m6->m4{[[[x3>=21/\x1<=20/\[x2>18\/x1-x2<1\/x3-x2<1]]/\[x1'=x1/\x2'=x2/\x3'=x3]]\/[[x3>=21/\x1<=18/\x2-x1>=1/\x2>20]/\[x1'=x1/\x2'=x2/\x3'=x3]]\/[[x2>20/\x1<=18/\x3-x1>=1/\x3<21]/\[x1'=x1/\x2'=x2/\x3'=x3]]]}
  m6->m5{[[[x3>=21/\x2<=20/\[x1>18\/x2-x1<1\/x3-x1<1]]/\[x1'=x1/\x2'=x2/\x3'=x3]]\/[[x3>=21/\x2<=18/\x1-x2>=1/\x1>20]/\[x1'=x1/\x2'=x2/\x3'=x3]]\/[[x1>20/\x2<=18/\x3-x2>=1/\x3<21]/\[x1'=x1/\x2'=x2/\x3'=x3]]]}
  m6->m7{[[x3>=21/\x1>=20/\[x2>18\/x1-x2<1\/x3-x2<1]]\/[x3>=21/\x2>=20/\[x1>18\/x3-x1<1\/x2-x1<1]]]/\[x1'=x1/\x2'=x2/\x3'=x3]}
  m7->m1{[[[x1<=20/\x2<=20/\[x3>18\/x1-x3<1\/x2-x3<1]]/\[x1'=x1/\x2'=x2/\x3'=x3]]\/[[x1<21/\x2<=18/\x3-x2>=1/\x3<21]/\[x1'=x1/\x2'=x2/\x3'=x3]]\/[[x2<21/\x1<=18/\x3-x1>=1/\x3<21]/\[x1'=x1/\x2'=x2/\x3'=x3]]]}
  m7->m2{[[[x1<=20/\x3<=20/\[x2>18\/x1-x2<1\/x3-x2<1]]/\[x1'=x1/\x2'=x2/\x3'=x3]]\/[[x1<21/\x3<=18/\x2-x3>=1/\x2<21]/\[x1'=x1/\x2'=x2/\x3'=x3]]\/[[x3<21/\x1<=18/\x2-x1>=1/\x2<21]/\[x1'=x1/\x2'=x2/\x3'=x3]]]}
  m7->m3{[[[x3<=20/\x2<=20/\[x1>18\/x3-x1<1\/x2-x1<1]]/\[x1'=x1/\x2'=x2/\x3'=x3]]\/[[x3<21/\x2<=18/\x1-x2>=1/\x1<21]/\[x1'=x1/\x2'=x2/\x3'=x3]]\/[[x2<21/\x3<=18/\x1-x3>=1/\x1<21]/\[x1'=x1/\x2'=x2/\x3'=x3]]]}
  m7->m4{[[[x1<=20/\[x2>18\/x1-x2<1\/x3-x2<1]/\x3>20]\/[x1<=20/\x2>20/\[x3>18\/x1-x3<1\/x2-x3<1]]/\[x1'=x1/\x2'=x2/\x3'=x3]]\/[[[x1<=18/\x2-x1>=1/\x2>20/\x3>20]\/[x1<=18/\x3-x1>=1/\x2>20/\x3>20]]/\[x1'=x1/\x2'=x2/\x3'=x3]]]}
  m7->m5{[[[x2<=20/\[x1>18\/x2-x1<1\/x3-x1<1]/\x3>20]\/[x2<=20/\x1>20/\[x3>18\/x1-x3<1\/x2-x3<1]]/\[x1'=x1/\x2'=x2/\x3'=x3]]\/[[[x2<=18/\x1-x2>=1/\x1>20/\x3>20]\/[x2<=18/\x3-x2>=1/\x1>20/\x3>20]]/\[x1'=x1/\x2'=x2/\x3'=x3]]]}
  m7->m6{[[[x3<=20/\[x2>18\/x1-x2<1\/x3-x2<1]/\x1>20]\/[x3<=20/\x2>20/\[x1>18\/x2-x1<1\/x3-x1<1]]/\[x1'=x1/\x2'=x2/\x3'=x3]]\/[[[x3<=18/\x2-x3>=1/\x2>20/\x1>20]\/[x3<=18/\x1-x3>=1/\x2>20/\x1>20]]/\[x1'=x1/\x2'=x2/\x3'=x3]]]}
UNSAFE
  m1{[x1<=14\/x2<=14\/x3<=14]}
  m2{[x1<=14\/x2<=14\/x3<=14]}
  m3{[x1<=14\/x2<=14\/x3<=14]}
  m4{[x1<=14]}
  m5{[x2<=14]}
  m6{[x3<=14]}